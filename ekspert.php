<?phprequire_once("_functions.php");require_once("_check_for_admin.php");site_head();?><style>    .titl1{font-size:20px;margin:0;padding:0;}    .titl2{font-size:20px!important;font-weight: 800;}    input[type=text]{height: 23px;padding-left:5px;}    input[type=button]{height: 23px;}    input[type=checkbox]{height:auto;margin:0;vertical-align: middle;cursor: pointer;}    select{height: 23px;}    textarea{height: 45px;padding-left:5px;}    input,select,textarea{        border:none; border-radius:2px;        border-top:solid 1px #7F7F7F; border-left:solid 1px #7F7F7F;        border-right:solid 1px #9B9B9B; border-bottom:solid 1px #9B9B9B;    }    .label1{width:100%;text-align:left;float:left;padding:0 0 0 5px;margin:0;top:1px;position:relative;}    .label2{padding:5px 5px 0 5px!important;margin:0;top:1px;position:relative;font-style: italic;font-weight: 400;}    .modal{padding:0;top:-2%;overflow:auto!important;}    .modal-content{background: rgb(247, 247, 255);}    #modal_window .modal-dialog,    #modal_window .modal-content{width:1200px;}    /*--------------------------------------------------------*/    /*---------- tablica s filtrom ----------*/    .table_ekspert tbody {        display:block;        height:400px;        overflow-y:scroll;        border: 1px solid rgba(0, 0, 0, 0.04);    }    .table_ekspert thead,    .table_ekspert tbody tr {        display:table;        width:100%;        table-layout:fixed;    }    .table_ekspert thead { width:calc(100% - 19px); margin-left: 1px; }    .table_ekspert table { width:100%; }    /*---------- tablica s filtrom ----------*/    .table_ekspert {width: 100%;}    .table_ekspert tr:hover {background-color: rgba(0, 255, 0, 0.16);}    .table_ekspert th{padding:5px 1px 5px 1px;margin:0;font-size:14px;line-height:1;border:1px solid rgba(105, 105, 105, 0.6);text-align:center;background-color:#e6e6e6;}    .table_ekspert td{padding:5px;margin:0;font-size:14px;line-height:1;border:1px solid rgba(156, 156, 156, 0.6);cursor:pointer;}    .table_ekspert td:nth-child(-n+2){padding:0;}    .table_ekspert tr:nth-child(1) th{padding:1px;font-weight: 400;}    /*--------------------------------------------------------*/    /*--------------------------------------------------------*/    .table_ekspert_tbl{width: 100%;}    .table_ekspert_tbl th{padding:0;margin:0;font-size:14px;line-height:1;border:1px solid rgba(105, 105, 105, 0.6);text-align:center;background-color:#e6e6e6;}    .table_ekspert_tbl td{padding:0;margin:0;font-size:14px;line-height:1;border:1px solid #e1e1e1;cursor:pointer;}    .table_ekspert_tbl tr:hover {background-color: rgba(0, 255, 0, 0.1);}    /*--------------------------------------------------------*/    .pagination>li>a{padding: 0 10px 2px 10px; font-size: 20px;}    .table_ekspert_page:hover{cursor: pointer;}    /*--------------------------------------------------------*/    /*--------------------------------------------------------*/    #menu_container{width:100%;}    #menu_left{float:left;width:200px;}    #menu_center{margin:0 auto;width:600px;}    /*--------------------------------------------------------*/    #add_ekspert,    #upd_ekspert,    #del_ekspert{padding:0 10px 0 10px;margin:0;border:2px solid #bfbfbf;border-radius:2px;font-size:16px;}    #add_ekspert:hover,    #upd_ekspert:hover,    #del_ekspert:hover{border: 2px solid #0080ff;}    #add_ekspert{background:rgba(0, 255, 0, 0.4);}    #upd_ekspert{background:rgba(255, 255, 0, 0.4);}    #del_ekspert{background:rgba(255, 0, 0, 0.4);}    /*--------------------------------------------------------*/    .sortirovka{width:70px;height:20px;padding:0 5px 0 5px;margin:0;float:left;border:2px solid transparent;font-size:12px;}    .sortirovka{background: rgba(0, 0, 0, 0.06);}    .sortirovka_select{width:110px;height:20px;padding:0 5px 0 5px;margin:0;float:left;border:2px solid transparent;font-size:12px;}    .sortirovka_select{background: rgba(0, 0, 0, 0.06);}    /*--------------------------------------------------------*/    #btn_tab1,    #btn_tab2 {        padding:0 5px 0 5px;margin:2px;font-size:14px;        border:2px solid #bfbfbf;border-radius:2px;        line-height:1;height:25px;vertical-align: middle;    }    #btn_tab1:hover,    #btn_tab2:hover{        border: 2px solid #0080ff;    }    .selected{background: rgba(0, 255, 0, 0.5);}    .not_selected{background: rgba(255, 255, 0, 0.5);}    /*--------------------------------------------------------*/    .btn_add_row,    .btn_upd_row,    .btn_del_row{        padding:0 10px 0 10px;margin:0 10px 0 10px;border:1px solid #bfbfbf;border-radius:0;        color: black; font-size:14px; font-weight:800;height: 18px; width: 125px;    }    .btn_add_row:hover,    .btn_upd_row:hover,    .btn_del_row:hover{border:1px solid #0000ff;}    .btn_add_row{background-color: rgba(0, 255, 0, 0.5);}    .btn_upd_row{background-color: rgba(255, 255, 0, 0.5);}    .btn_del_row{background-color: rgba(255, 0, 0, 0.5);}    /*---------------------   main_body   --------------------*/    #main_body{margin:5px;}    /*---------------------   main_body   --------------------*/    /*--------------------------------------------------------*/    .otvet_prav{color: #00bf00;}    .otvet_ne_prav{color: #df0000;}    .select_disabled{color: black;background: #ebebeb; font-weight: 800;}    .hr1{border-top:1px /*dotted*/solid rgba(0, 0, 128, 0.5);padding:0 1px 0 1px;margin:0;}    /*--------------------------------------------------------*/    .select2,    .select2-container{width:100%!important;float:none;text-align:left}    .select2-container .select2-selection--multiple .select2-selection__rendered{white-space: normal;}    .select2-container--default .select2-selection--single .select2-selection__rendered{padding-left:5px;}    .select2-container--default .select2-selection--multiple .select2-selection__choice{width:100%;padding:3px 5px;}    .select2-selection{border-radius:1px!important;}    /*--------------------------------------------------------*/</style><script>    function check_details_tab(tab_num){        var mass=[], i=0;        $("details.details_tab"+tab_num).each(function() {            if($(this).attr("open")){                mass[i] = 'open';            }else{                mass[i] = '';            }            i++;        });        return mass;    }    function get_row_id_in_table_ekspert(){        var id=0;        $('.table_ekspert input:checkbox:checked').each(function(){id=$(this).val()});        return id;    }    function switch_details_window(tab_num) {        $('' +            '.details_tab' + tab_num + '.details_window01,' +            '.details_tab' + tab_num + '.details_window02,' +            '.details_tab' + tab_num + '.details_window03,' +            '.details_tab' + tab_num + '.details_window04,' +            '.details_tab' + tab_num + '.details_window05,' +            '.details_tab' + tab_num + '.details_window06,' +            '.details_tab' + tab_num + '.details_window07,' +            '.details_tab' + tab_num + '.details_window08,' +            '.details_tab' + tab_num + '.details_window09,' +            '.details_tab' + tab_num + '.details_window10,' +            '.details_tab' + tab_num + '.details_window11,' +            '.details_tab' + tab_num + '.details_window12,' +            '.details_tab' + tab_num + '.details_window13,' +            '.details_tab' + tab_num + '.details_window14,' +            '.details_tab' + tab_num + '.details_window15'        ).click(function (event) {            for (var i = 1; i <= 15; i++) {                if (i < 10) i = '0' + i;                $('.details_tab' + tab_num + '.details_window' + i).not(this).not('.details_window0').removeAttr("open");            }        });        //--------------------------------------------------------------//        $('input, :input').attr('autocomplete', 'off');    }    function select_checkbox_in_table_ekspert(){        var touchtime = 0, tmp, td_index=0;        $(".table_ekspert td").click(function() {            if (touchtime == 0) {                touchtime = new Date().getTime();                tmp = $(this).closest('tr').find('td:eq(0)').html();                if ($('.table_ekspert #ch' + tmp).is(':checked')) {                    $('.table_ekspert #ch' + tmp).prop('checked', false);                } else {                    $('.table_ekspert :checkbox').prop('checked', false);                    $('.table_ekspert #ch' + tmp).prop('checked', true);                }            } else {                if (((new Date().getTime()) - touchtime) < 300) {                    tmp = $(this).closest('tr').find('td:eq(0)').html();                    if (!$('.table_ekspert #ch' + tmp).is(':checked')) {                        $('.table_ekspert :checkbox').prop('checked', false);                        $('.table_ekspert #ch' + tmp).prop('checked', true);                    }                    //----- upd                    if(get_row_id_in_table_ekspert()>0){                        td_index = $(this).index();                        if(td_index>=2){                            td_index=td_index-2;                        }                        table_ekspert_select(td_index);                    }                    //----- upd                }else{                    touchtime = new Date().getTime();                    tmp = $(this).closest('tr').find('td:eq(0)').html();                    if ($('.table_ekspert #ch' + tmp).is(':checked')) {                        $('.table_ekspert #ch' + tmp).prop('checked', false);                    } else {                        $('.table_ekspert :checkbox').prop('checked', false);                        $('.table_ekspert #ch' + tmp).prop('checked', true);                    }                }            }        });        $(".table_ekspert :checkbox").click(function () {            if ($(this).is(':checked')) {                $(this).prop('checked', false);            } else {                $('.table_ekspert :checkbox').prop('checked', false);                $(this).prop('checked', true);            }        });    }    function table_ekspert_show(id=0,page=0){        //------------------------------------------------------------//        var last_selected_page = 0;        if(page!=0){            last_selected_page = page;        }else{            last_selected_page = $('.table_ekspert_page ul.pagination li.active a').html();        }        //------------------------------------------------------------//        var last_selected_id = 0;        if(id!=0){            last_selected_id = id;        }else{            last_selected_id = get_row_id_in_table_ekspert();        }        //------------------------------------------------------------//        $('#main_table_body').html('Загрузка ...');        var data = $.ajax({            type: 'GET',            url: "add_upd_del/table_ekspert_show.php",            data: {                last_selected_id:last_selected_id,                sortirovka:$('#sortirovka').val(),                filtr_fio:$('#filtr_fio').val(),                filtr_id_yroven_obrazov:$('#filtr_id_yroven_obrazov').val(),                page:last_selected_page,                max_values_in_table:10            },            dataType: 'html', context: document.body, global: false, async: false,            success: function (data) {                return data;            }        }).responseText;        //------------------------------------------------------------//        $('#main_table_body').html(data);        select_checkbox_in_table_ekspert();        //--------------------------------------------------------------//        $('input, :input').attr('autocomplete', 'off');        //--------------------------------------------------------------//        table_ekspert_show_page(last_selected_page);    }    function table_ekspert_show_page(page=0){        //------------------------------------------------------------//        var last_selected_page = 1;        if(page!=0){            last_selected_page = page;        }        //------------------------------------------------------------//        $('.table_ekspert_page').html('...');        var data = $.ajax({            type: 'GET',            url: "add_upd_del/table_ekspert_show_page.php",            data: {                sortirovka:$('#sortirovka').val(),                filtr_fio:$('#filtr_fio').val(),                filtr_id_yroven_obrazov:$('#filtr_id_yroven_obrazov').val(),                page:last_selected_page,                max_values_in_table:10            },            dataType: 'html', context: document.body, global: false, async: false,            success: function (data) {                return data;            }        }).responseText;        //------------------------------------------------------------//        $('.table_ekspert_page').html(data);        //--------------------------------------------------------------//    }    function table_ekspert_select(td_index=0){        $('#modal_window').modal('show');        //select_button('#btn_tab'+td_index);        select_button('#btn_tab1');    }    function table_ekspert_tab1_select(tmp_id_ekspert=0){        clear_all_errors();        //------------------------------------------------------------//        var id_ekspert = 0;        if(tmp_id_ekspert!=0){            id_ekspert = tmp_id_ekspert;        }else{            id_ekspert = get_row_id_in_table_ekspert();        }        //--------------------------------------------------------------//        var data = $.ajax({            type: 'GET',            url: "add_upd_del/table_ekspert_tab1_select.php",            data: {                details_open: check_details_tab(1),                id_ekspert: id_ekspert            },            dataType: 'html', context: document.body, global: false, async: false,            success: function (data) {                return data;            }        }).responseText;        //--------------------------------------------------------------//        $("#modal_body").html(data);        //--------------------------------------------------------------//        //--------------------------------------------------------------//        switch_details_window(1);    }    function table_ekspert_tab2_select(){        clear_all_errors();        //--------------------------------------------------------------//        var data = $.ajax({            type: 'GET',            url: "add_upd_del/table_ekspert_tab2_select.php",            data: {                details_open: check_details_tab(2),                id_ekspert: get_row_id_in_table_ekspert()            },            dataType: 'html', context: document.body, global: false, async: false,            success: function (data) {                return data;            }        }).responseText;        //--------------------------------------------------------------//        $("#modal_body").html(data);        //--------------------------------------------------------------//        //--------------------------------------------------------------//        switch_details_window(2);    }    function table_ekspert_save(){        clear_all_errors();        if($('#btn_tab1').hasClass('selected')) {table_ekspert_tab1_save();}        if($('#btn_tab2').hasClass('selected')) {table_ekspert_tab2_save();}    }    function table_ekspert_tab1_save(){        clear_all_errors();    }    function table_ekspert_tab2_save(){        clear_all_errors();    }    function table_ekspert_del(){        var id_ekspert = get_row_id_in_table_ekspert();        if(id_ekspert>0){            if (confirm('Удалить ?')) {                //------------------------------------------------------------//                var data = $.ajax({                    type: 'GET',                    url: "add_upd_del/table_ekspert_del.php",                    data: {                        id_ekspert: id_ekspert                    },                    dataType: 'html', context: document.body, global: false, async: false,                    success: function (data) {                        return data;                    }                }).responseText;                //------------------------------------------------------------//                if(data==''){                    table_ekspert_show();                }else{                    alert(data);                }            }        }    }    //---------------------------------------------------------------------------------------------------------------//    function clear_all_values(){    }    function clear_all_errors(){        $('input').attr('autocomplete','off');        $('input, select, textarea').css({            'border': 'none',            'border-top': 'solid 1px rgba(127, 127, 127, 0.9)',            'border-left': 'solid 1px rgba(127, 127, 127, 0.9)',            'border-right': 'solid 1px rgba(127, 127, 127, 0.7)',            'border-bottom': 'solid 1px rgba(127, 127, 127, 0.7)',            'border-radius': '2px',            'border-width': '1px'        });        //$('#checkboxid').css({'outline': 'none'});        $(".error_mssg1, .success_mssg1").html('');    }</script><div style="text-align: center;margin-left: 5px;margin-right: 5px">    <p class="titl1">Эксперты</p>    <div id="menu_container">        <div id="menu_left">            <button type="button" class="sortirovka">Сортировка: </button>            <select id='sortirovka' class='sortirovka_select'>                <option value='0'>Дата создания</option>                <option value='1' selected>ФИО (А&#8594;Я)</option>            </select>        </div>        <div id="menu_center">            <button type="button" id="add_ekspert">Добавить эксперта</button>            <button type="button" id="upd_ekspert">Редактировать эксперта</button>            <button type="button" id="del_ekspert">Удалить эксперта</button>        </div>    </div>    <div id="main_body">        <table class='table_ekspert'>            <thead>            <tr>                <th class='w25px'><input disabled type="text" class="w100"></th>                <th class='w20px'><input disabled type="text" class="w100"></th>                <th class='w250px'>                    <input type="text" class="w100" id="filtr_fio">                </th>                <th class='w200px'>                    <select id='filtr_id_yroven_obrazov' class='w100'><option></option>                        <?php                        $sql = "SELECT id, name FROM tvidi_yroven_obrazov where udln is null order by sort";                        $res = mysqli_query($db, $sql);                        while ($line = mysqli_fetch_array($res, MYSQLI_NUM)) {                            $disabled = '';                            if ($line[2] == 1) $disabled = "disabled class='select_disabled'";                            print"<option $disabled value='$line[0]'>$line[1]</option>";                        }                        ?>                    </select>                </th>                <th class='w100px'>                    <input type="text" class="w100" id="filtr_procent_prav_otvetov">                </th>                <th class='w100px'></th>                <th class='w100px'></th>                <th class=''></th>            </tr>            <tr>                <th class='w25px'>№<br>п.п.</th>                <th class='w20px'></th>                <th class='w250px'>Фамилия Имя Отчество</th>                <th class='w200px'>Уровень образования</th>                <th class='w100px'>Результат</th>                <th class='w100px'>Результат подтвердил</th>                <th class='w100px'>Скачать<br>индивид. лист</th>                <th class=''></th>            </tr>            </thead>            <tbody id="main_table_body"></tbody>        </table>        <table class='table_ekspert_page' align="center"></table>    </div>    <div class="modal fade" align="center" id="modal_window" tabindex="-1" role="dialog" aria-labelledby="modal_label">        <div class="modal-dialog" role="document" id="modal_dialog">            <div class="modal-content">                <div class="modal-header">                    <span class="modal-title" id="modal_label">&#160;</span>                </div>                <button type="button" class="w100px" id="btn_tab1" onclick="select_button('#btn_tab1')">Тесты</button>                <button type="button" class="w100px" id="btn_tab2" onclick="select_button('#btn_tab2')">Собеседование</button>                <div class="modal-body" id="modal_body">                    ...                </div>                <div class="modal-footer">                    <button type="button" class="btn btn-default" data-dismiss="modal">Закрыть</button>                    <button type="button" class="btn btn-primary" onclick="table_ekspert_save()">Сохранить</button>                    <div class="error_mssg1"></div>                    <div class="success_mssg1"></div>                </div>            </div>        </div>    </div></div><form hidden method="get" id="form_doc">    <input id='id_eksperttest_doc' name='id_eksperttest_doc'>    <input id='submit_doc' name='submit_doc'></form><script>    table_ekspert_show();    //-------------------------------------------------------------------------------------------------------//    $('#sortirovka,#filtr_id_yroven_obrazov').on('change', function () {        $('.table_ekspert_page ul.pagination li.active a').html('1');        table_ekspert_show();    });    $('#filtr_fio,#filtr_procent_prav_otvetov').on('keyup', function () {        $('.table_ekspert_page ul.pagination li.active a').html('1');        table_ekspert_show();    });    //-------------------------------------------------------------------------------------------------------//    $('#upd_ekspert').on('click', function () {if(get_row_id_in_table_ekspert()!=0) table_ekspert_select();});    $('#del_ekspert').on('click', function () {table_ekspert_del();});    function select_button(btn){        clear_all_errors();        //----------------------------------------------------------------------//        $('#btn_tab1,#btn_tab2').removeClass('selected not_selected').addClass('not_selected');        $(btn).removeClass('not_selected').addClass('selected');        //----------------------------------------------------------------------//        if($('#btn_tab1').hasClass('selected')) {table_ekspert_tab1_select();}        if($('#btn_tab2').hasClass('selected')) {table_ekspert_tab2_select();}    }    //-------------------------------------------------------------------------------------------------------//    $('#modal_window').on('hidden.bs.modal', function (e) {        $('#modal_body').html('');        clear_all_errors();        $("div.autocomplete-suggestions").detach();        table_ekspert_show();    });    //-------------------------------------------------------------------------------------------------------//    function individyalnii_list_doc(id=0) {        $("#id_eksperttest_doc").val(id);        $("#form_doc").attr('action', 'reports/individyalnii_list_doc.php');        $("#submit_doc").attr('type', 'submit').click();    }    //-------------------------------------------------------------------------------------------------------//    $('#page_ekspert').addClass('selected_page').css("color","black");</script><?phpsite_foot();?>